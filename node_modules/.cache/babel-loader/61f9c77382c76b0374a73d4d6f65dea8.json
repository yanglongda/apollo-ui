{"remainingRequest":"/Users/long/Desktop/apollo-ui/node_modules/babel-loader/lib/index.js!/Users/long/Desktop/apollo-ui/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/long/Desktop/apollo-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/long/Desktop/apollo-ui/src/views/organization/department/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/long/Desktop/apollo-ui/src/views/organization/department/index.vue","mtime":1599459833723},{"path":"/Users/long/Desktop/apollo-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/long/Desktop/apollo-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/long/Desktop/apollo-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/long/Desktop/apollo-ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.sort\";\nimport \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getList, handleQuery as _handleQuery, levels, addDept, getParent as _getParent, getDept, addDept2, deleteDept } from \"@/api/organization/department\";\nexport default {\n  name: 'department',\n  data: function data() {\n    return {\n      data: [{\n        numb: '部门1',\n        schoolName: '单位1',\n        year: '',\n        className: '',\n        name: ''\n      }],\n      title: '新增',\n      row: '',\n      yearList: [],\n      levels: [],\n      classList: [],\n      unitList: [],\n      deptList: [],\n      adata: [],\n      total: 10,\n      loading: false,\n      dialogFormVisible: false,\n      isdisabled: false,\n      isshow: false,\n      form: {\n        levelId: '',\n        class: '',\n        deptName: '',\n        page: 1,\n        size: 10\n      },\n      ruleForm: {\n        deptName: '',\n        level: '',\n        levelId: '',\n        unitId: '',\n        unitName: '',\n        sort: '',\n        parent: '',\n        parentName: '',\n        id: ''\n      },\n      rules: {\n        deptName: [{\n          required: true,\n          message: \"请输入部门名称\",\n          trigger: \"blur\"\n        }],\n        unitId: [{\n          required: true,\n          message: \"所属单位不能为空\",\n          trigger: \"blur\"\n        }],\n        levelId: [{\n          required: true,\n          message: \"部门层级不能为空\",\n          trigger: \"blur\"\n        }]\n      }\n    };\n  },\n  mounted: function mounted() {\n    this.handleQuery();\n    this.getInfo();\n    this.handleSelect();\n  },\n  methods: {\n    getInfo: function getInfo() {\n      var _this = this;\n\n      getList().then(function (res) {\n        if (res.data.code == 200) {\n          console.log(res.data.data);\n          _this.unitList = res.data.data;\n        } else {\n          _this.msgError(res.message);\n        }\n      });\n      levels().then(function (res) {\n        if (res.data.code == 200) {\n          _this.levels = res.data.data;\n        } else {\n          _this.msgError(res.message);\n        }\n      });\n    },\n    handleruleForm: function handleruleForm() {\n      var _this2 = this;\n\n      //修改\n      this.$refs[\"ruleForm\"].validate(function (valid) {\n        if (valid) {\n          console.log(_this2.row);\n\n          if (_this2.row) {\n            console.log(_this2.row, '修改');\n            addDept2(_this2.ruleForm).then(function (res) {\n              if (res.data.code === 200) {\n                console.log(res);\n                _this2.dialogFormVisible = false;\n\n                _this2.handleQuery();\n              } else {\n                _this2.msgError(res.message);\n              }\n            });\n          } else {\n            addDept(_this2.ruleForm).then(function (res) {\n              if (res.data.code === 200) {\n                console.log(res);\n                _this2.dialogFormVisible = false;\n\n                _this2.handleQuery();\n              } else {\n                _this2.msgError(res.message);\n              }\n            });\n          }\n        }\n      });\n    },\n    getParent: function getParent(id) {\n      var _this3 = this;\n\n      _getParent(id).then(function (res) {\n        if (res.data.code == 200) {\n          _this3.deptList = res.data.data;\n\n          _this3.change3();\n        } else {\n          _this3.msgError(res.message);\n        }\n      });\n    },\n    change1: function change1(row) {\n      this.ruleForm.unitName = '';\n      this.ruleForm.unitName = this.unitList[row - 1].name;\n      console.log(this.ruleForm.unitName);\n      var id = this.ruleForm.unitId;\n      this.getParent(id);\n      this.$forceUpdate();\n    },\n    change2: function change2(row) {\n      this.ruleForm.level = '';\n      this.ruleForm.level = this.levels[row - 1].level;\n      console.log(this.ruleForm.level);\n\n      if (this.ruleForm.levelId == '1') {\n        this.ruleForm.parent = '';\n        this.isdisabled = true;\n        this.isshow = true;\n      } else {\n        this.isdisabled = false;\n        this.isshow = false;\n      }\n\n      this.$forceUpdate();\n    },\n    change3: function change3() {\n      this.$forceUpdate();\n    },\n    handleQueryForm: function handleQueryForm() {\n      this.form.page = 1;\n      this.handleQuery();\n    },\n    handleQuery: function handleQuery() {\n      var _this4 = this;\n\n      this.loading = true;\n\n      _handleQuery(this.form).then(function (res) {\n        if (res.data.code == 200) {\n          _this4.total = res.data.data.total;\n\n          if (res.data.data.records.length === 0) {\n            _this4.data = [];\n          } else {\n            _this4.data = res.data.data.records;\n          }\n\n          _this4.loading = false;\n        } else {\n          _this4.msgError(res.message);\n        }\n\n        _this4.$forceUpdate();\n      });\n    },\n    handleSelect: function handleSelect() {},\n    addDep: function addDep(row) {\n      var _this5 = this;\n\n      this.dialogFormVisible = true;\n\n      if (row.id) {\n        this.resetForm(this.ruleForm);\n        this.title = '修改';\n        this.row = row.id;\n        getDept(row.id).then(function (res) {\n          if (res.data.code == 200) {\n            _this5.ruleForm.id = row.id;\n            _this5.ruleForm.deptName = res.data.data.deptName;\n            _this5.ruleForm.unitId = res.data.data.unitId;\n            _this5.ruleForm.unitName = res.data.data.unitName;\n            _this5.ruleForm.level = res.data.data.level;\n            _this5.ruleForm.levelId = res.data.data.levelId;\n\n            if (res.data.data.parent === 0) {\n              _this5.ruleForm.parent = '';\n              _this5.ruleForm.parentName = '';\n            } else {\n              _this5.ruleForm.parent = res.data.data.parent;\n              _this5.ruleForm.parentName = res.data.data.parentName;\n            }\n\n            _this5.ruleForm.sort = res.data.data.sort;\n            console.log(_this5.ruleForm); // this.change1()\n            // this.change2()\n            // this.change3()\n\n            _this5.$forceUpdate();\n          } else {\n            _this5.ruleForm.unitId = res.data.data.unitId;\n          }\n        });\n      } else {\n        this.row = '';\n        this.ruleForm = {\n          deptName: '',\n          level: '',\n          levelId: '',\n          unitId: '',\n          unitName: '',\n          sort: '',\n          parent: '',\n          parentName: '',\n          id: ''\n        };\n        this.title = '新增';\n      }\n    },\n    deleteDep: function deleteDep(row) {\n      var _this6 = this;\n\n      if (row.id) {\n        this.$confirm(\"部门删除后将不可恢复\", \"警告\", {\n          confirmButtonText: \"确定\",\n          cancelButtonText: \"取消\",\n          type: \"warning\"\n        }).then(function () {\n          return deleteDept(row.id);\n        }).then(function (res) {\n          if (res.data.code === 200) {\n            _this6.handleQuery();\n          } else {\n            _this6.msgError(res.message);\n          }\n        });\n      }\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"career\">\n        <el-form ref=\"form\" class=\"form\" :model=\"form\">\n            <el-form-item label=\"部门层级\" style=\"width:310px\">\n            <el-select v-model=\"form.levelId\" style=\"width:224px;\" filterable placeholder=\"请选择\">\n                <el-option label=\"全部\" value=\"\"></el-option>\n                <el-option v-for=\"item in levels\" :key='item.levelId' :label=\"item.level\" :value=\"item.levelId\"></el-option>\n                </el-select>\n            </el-form-item>\n            <el-form-item label=\"搜索\" style=\"width:290px;\">\n            <el-input v-model=\"form.deptName\"  style=\"width:240px;\" placeholder=\"按部门名称搜索\"></el-input>\n            </el-form-item>\n            <el-form-item>\n            <el-button type=\"primary\" @click=\"handleQueryForm\">搜索</el-button>\n            <el-button type=\"primary\" @click=\"addDep\">新增</el-button>\n            </el-form-item>\n        </el-form>\n        <el-table\n        v-loading=\"loading\"\n        class=\"table-num\"\n        :data=\"data\"\n        >\n        <tamplate slot='empty'>\n            <p style=\"font-size:12px;margin:0;\">暂无数据，<el-botton size=\"mini\" type=\"text\" @click=\"addDep\" style=\"cursor:pointer;color: #409eff;\">点击新增</el-botton></p>\n        </tamplate>    \n        <el-table-column label=\"部门名称\" align=\"center\" prop=\"deptName\"/>\n        <el-table-column label=\"所属单位\" align=\"center\" prop=\"unitName\" />\n        <el-table-column label=\"部门层级\" align=\"center\" prop=\"level\" />\n        <el-table-column label=\"上级部门\" align=\"center\" prop=\"parentName\" />\n        <el-table-column label=\"部门排序码\" align=\"center\" prop=\"sort\" />\n        <el-table-column label=\"操作\" align=\"center\" >\n            <template slot-scope=\"scope\">\n                <el-button size=\"mini\" type=\"text\" style=\"font-size:12px;color: #409eff;\" @click=\"addDep(scope.row)\">修改</el-button>\n                <el-button size=\"mini\" type=\"text\" style=\"font-size:12px;color: #409eff;\" @click=\"deleteDep(scope.row)\">删除</el-button>\n            </template>\n        </el-table-column>\n      </el-table>\n      <div class=\"pos\">\n        <pagination\n          v-show=\"total>0\"\n          :total=\"total\"\n          :page.sync=\"form.page\"\n          :limit.sync=\"form.size\"\n          @pagination=\"handleQuery\"\n        />\n      </div>\n      <el-dialog\n        :title=\"title\"\n        class=\"dialogFormVisible\"\n        :visible.sync=\"dialogFormVisible\"\n        append-to-body\n      >\n\n        <el-form :model=\"ruleForm\" :rules=\"rules\" ref=\"ruleForm\">\n          <el-form-item label=\"部门名称\" style=\"\" prop=\"deptName\">\n            <el-input v-model=\"ruleForm.deptName\" style=\"width:250px;\" placeholder=\"输入部门名称\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"所属单位\" style=\"\" prop=\"unitId\">\n            <el-select v-model=\"ruleForm.unitId\" filterable style=\"width:250px;\" @change=\"change1\" placeholder=\"请选择\">\n              <el-option v-for=\"item in unitList\" :key='item.id' :label=\"item.name\" :value=\"item.id\"></el-option>\n               \n            \n            </el-select>\n          </el-form-item>\n\n          <el-form-item label=\"部门层级\" style=\"\" prop=\"levelId\">\n            <el-select v-model=\"ruleForm.levelId\" filterable style=\"width:250px;\" @change=\"change2\" placeholder=\"请选择\">\n            \n            <el-option v-for=\"item in levels\" :key='item.levelId' :label=\"item.level\" :value=\"item.levelId\"></el-option>\n               \n            </el-select>\n          </el-form-item>\n          <el-form-item label=\"上级部门\" style=\"padding-left:10px\"  prop=\"parent\">\n            <el-select v-model=\"ruleForm.parent\" filterable style=\"width:250px;\" @change=\"change3\" :disabled=\"isdisabled\" placeholder=\"请选择\">\n                <el-option label=\"无\" value=\"\"></el-option>\n                <el-option v-for=\"item in deptList\" :key='item.id' :label=\"item.deptName\" :value=\"item.id\"></el-option>\n\n            </el-select>\n            <span id=\"wuxu\" v-show=\"isshow\">无需填写</span>\n          </el-form-item>\n           <el-form-item label=\"部门排序码\" style=\"padding-right:5px;\" prop=\"sort\">\n            <el-input v-model=\"ruleForm.sort\" style=\"width:250px;\" placeholder=\"如0001，不输入默认排在最后\"></el-input>\n          </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button type=\"primary\" @click=\"handleruleForm\">确 定</el-button>\n          <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n        </div>\n      </el-dialog>\n\n    </div>\n\n</template>\n\n<script>\nimport {getList,handleQuery,levels,addDept,getParent,getDept,addDept2,deleteDept} from \"@/api/organization/department\"\nexport default {\n    name:'department',\n    data(){\n        return{\n            data:[\n                {\n                    numb:'部门1',\n                    schoolName:'单位1',\n                    year:'',\n                    className:'',\n                    name:''\n                }\n            ],\n            title:'新增',\n            row:'',\n            yearList:[],\n            levels:[],\n            classList:[],\n            unitList:[],\n            deptList:[],\n            adata:[],\n            total:10,\n            loading:false,\n            dialogFormVisible:false,\n            isdisabled:false,\n            isshow:false,\n            form:{\n                levelId:'',\n                class:'',\n                deptName:'',\n                page:1,\n                size:10,    \n            },\n            ruleForm:{\n                deptName:'',\n                level:'',\n                levelId:'',\n                unitId:'',\n                unitName:'',\n                sort:'',\n                parent:'',\n                parentName:'',\n\n                id:''\n            },\n            rules:{\n                deptName: [{ required: true, message: \"请输入部门名称\", trigger: \"blur\" }],\n                unitId: [{ required: true, message: \"所属单位不能为空\", trigger: \"blur\" }],\n                levelId: [{ required: true, message: \"部门层级不能为空\", trigger: \"blur\" }],\n            }\n        }\n    },\n    mounted(){\n        this.handleQuery()\n        this.getInfo()\n        this.handleSelect()\n    },\n    methods:{\n        getInfo(){\n          getList().then(res=>{\n              if(res.data.code==200){\n                console.log(res.data.data)\n                this.unitList=res.data.data\n              }else{\n                this.msgError(res.message)\n              }\n            })\n            levels().then(res=>{\n              if(res.data.code==200){\n                this.levels=res.data.data\n              }else{\n                this.msgError(res.message)\n              }\n            })\n        },\n        handleruleForm(){\n             //修改\n             \n             this.$refs[\"ruleForm\"].validate((valid) => {\n                if (valid) {\n                  console.log(this.row)\n                  if(this.row){\n                    console.log(this.row,'修改')\n                  addDept2(this.ruleForm).then(res=>{\n                    if(res.data.code===200){\n                      console.log(res)\n                      this.dialogFormVisible=false\n                      this.handleQuery()\n                    }else{\n                      this.msgError(res.message)\n                    }  \n                  })   \n                  }else{\n                     addDept(this.ruleForm).then(res=>{\n                    if(res.data.code===200){\n                      console.log(res)\n                      this.dialogFormVisible=false\n                      this.handleQuery()\n                    }else{\n                      this.msgError(res.message)\n                    }  \n                  })   \n                }\n                }\n             })\n            \n        },\n        getParent(id){\n          getParent(id).then(res=>{\n            if(res.data.code==200){\n              this.deptList=res.data.data\n              this.change3()\n            }else{\n              this.msgError(res.message)\n            }\n          })\n        },\n        change1(row){\n            this.ruleForm.unitName=''\n            this.ruleForm.unitName=this.unitList[row-1].name\n            console.log(this.ruleForm.unitName)\n            let id=this.ruleForm.unitId\n            this.getParent(id)\n            this.$forceUpdate()\n        },\n        change2(row){\n            this.ruleForm.level=''\n            this.ruleForm.level=this.levels[row-1].level\n            console.log(this.ruleForm.level)\n            if(this.ruleForm.levelId=='1'){\n                this.ruleForm.parent=''\n                this.isdisabled=true\n                this.isshow=true\n            }else{\n              \n                this.isdisabled=false\n                this.isshow=false\n            }\n            this.$forceUpdate()\n        },\n        change3(){\n            \n            this.$forceUpdate()\n        },\n        handleQueryForm(){\n          this.form.page=1\n          this.handleQuery()\n        },\n        handleQuery(){\n          this.loading=true\n             handleQuery(this.form).then(res=>{\n              if(res.data.code==200){\n                this.total=res.data.data.total\n                if(res.data.data.records.length===0){\n                  this.data=[]\n                }else{\n                  this.data=res.data.data.records\n                }\n                this.loading=false\n              }else{\n                this.msgError(res.message)\n              }\n              this.$forceUpdate()\n            })\n        },\n        handleSelect(){\n          \n        },\n        addDep(row){\n            this.dialogFormVisible=true\n            if(row.id){\n                this.resetForm(this.ruleForm)\n                this.title='修改'\n                this.row=row.id\n                getDept(row.id).then(res=>{\n                  if(res.data.code==200){\n                    this.ruleForm.id=row.id\n                    this.ruleForm.deptName=res.data.data.deptName\n                    this.ruleForm.unitId=res.data.data.unitId\n                    this.ruleForm.unitName=res.data.data.unitName\n                    this.ruleForm.level=res.data.data.level\n                    this.ruleForm.levelId=res.data.data.levelId\n                    if(res.data.data.parent===0){\n                    this.ruleForm.parent=''\n                    this.ruleForm.parentName=''\n                    }else{\n                    this.ruleForm.parent=res.data.data.parent\n                    this.ruleForm.parentName=res.data.data.parentName\n                    }\n                    this.ruleForm.sort=res.data.data.sort\n                    console.log(this.ruleForm)\n                    // this.change1()\n                    // this.change2()\n                    // this.change3()\n                     this.$forceUpdate()\n                  }else{\n                    this.ruleForm.unitId=res.data.data.unitId\n                  }\n                })\n            }else{\n                this.row=''\n                this.ruleForm={\n                  deptName:'',\n                level:'',\n                levelId:'',\n                unitId:'',\n                unitName:'',\n                sort:'',\n                parent:'',\n                parentName:'',\n\n                id:''\n                }\n                this.title='新增'\n            }\n        },\n        deleteDep(row){\n          if(row.id){\n            this.$confirm(\"部门删除后将不可恢复\", \"警告\", {\n              confirmButtonText: \"确定\",\n              cancelButtonText: \"取消\",\n              type: \"warning\",\n            })\n              .then(function () {\n                return deleteDept(row.id);\n              })\n              .then((res) => {\n                if(res.data.code===200){\n                  this.handleQuery()\n                }else{\n                  this.msgError(res.message)\n                }\n              })\n          }\n        }\n    }\n}\n</script>\n<style lang=\"scss\" scoped>\n.career{\n  width: calc(100% - 40px);\n  margin: 0px 20px 75px 20px;\n  background: #fff;\n\n  border-radius: 20px;\n  min-height: calc(100vh - 178px);\n  padding:  30px;\n  position: relative;\n}\n/deep/ .el-form-item{\n    display:inline-block;\n}\n.pos{\n    position: absolute;\n    right:10px;\n    bottom:20px;\n}\n/deep/ .el-dialog{\n    width:600px;\n}\n.dialogFormVisible {\n  /deep/ .el-form-item {\n    margin-bottom: 22px;\n    display: flex;\n    justify-content: center;\n  }\n  /deep/ .el-dialog__body {\n    padding: 30px 20px 0 20px;\n  }\n  #wuxu{\n    position: absolute;\n    top: 30px;\n    left: 0;\n    font-size: 12px;\n    color:#999;\n  }\n}\n</style>"],"sourceRoot":"src/views/organization/department"}]}